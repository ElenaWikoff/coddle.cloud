runtime: python310
entrypoint: gunicorn -b :$PORT backend.main:app

# API routes handled by Flask (FIRST)
handlers:
  - url: /api/.*
    script: auto

  - url: /static
    static_dir: backend/static
  
# Frontend Routes from frontend/dist
handlers:
  
  # Serve static folders from Vite build
  - url: /assets
    static_dir: frontend/dist/assets

  - url: /data
    static_dir: frontend/dist/data

  - url: /images
    static_dir: frontend/dist/images

  - url: /videos
    static_dir: frontend/dist/videos

  # Serve specific static files
  - url: /logo\.svg
    static_files: frontend/dist/logo.svg
    upload: frontend/dist/logo\.svg

  # Serve index.html for all other frontend routes (client-side routing)
  - url: /
    static_files: frontend/dist/index.html
    upload: frontend/dist/index.html

  - url: /.*
    static_files: frontend/dist/index.html
    upload: frontend/dist/index.html